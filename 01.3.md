# 1.3 Команды Go

## Команды Go

Язык Go поставляется с полным набором команд, которые вы можете увидеть, выполнив команду `go`:

![](images/1.3.go.png?raw=true)

Рисунок 1.3 Комнада Go отображает детализированную информацию

Каждая из команд весьма полезна для нас, потому давайте рассмотрим каждую из них.

## go build

Эта команда служит для компиляции. При наличии зависимых пакетов, они также будут скомпилированы при необходимости.

- Если пакет не является `main` пакетом, как например, пакет `mymath` в предыдущей [секции 1.2](01.2.md), то после выполнения команды ничего не будет создано. Если уж вам необходим скомпилированный файл пакета с расширением `.a` где-нибудь в `$GOPATH/pkg`, воспользуйтесь командой `go install`.
- Если обрабатываемый пакет `main`, то в исходной директории будет создан исполняемый файл. Если вы желаете, чтобы он был сгенерирован в папке `$GOPATH/bin`, запустите `go install` или `go build -o ${PATH_HERE}/a.exe.` - результат будет одинаков.
- Если в папке много различных файлов, а вы хотите скомпилировать только один из них, то просто добавьте его название после `go build`. Например так: `go build a.go`. `go build` будет компилировать все файлы в папке.
- Вы также вправе указать название файла, который будет создан. Например, для пакета `mathapp` [секции 1.2](01.2.md), команда `go build -o astaxie.exe` создаст файл `astaxie.exe` вместо `mathapp.exe`. Имя по умолчанию, которое будет использоваться - это название папки пакета(не `main` пакета) или название первого исходного файла(соответственно для `main` пакета).

(В соответствии [спецификацией языка Go](https://golang.org/ref/spec), именем пакета является имя после слова `package` в первой строке исходного файла, оно может быть отличным от названия папки, а именем исполняемого файла по умолчанию будет название папки.) 

- `go build` игнорирует названия файлов, начинающиеся с символов `_` или `.`.
- Если вы желаете иметь различные исходные файлы для различных платформ, то можно называть файлы, просто добавляя в конце имени суффикс с названием платформы. Пусть у нас есть некоторые исходные файлы, которые работают с массивами, то они могут быть названы примерно так:
	
	array_linux.go | array_darwin.go | array_windows.go | array_freebsd.go
	
`go build` выберет тот исходник, который ассоциирован с вашей операционной системой. Например команда скомпилирует `array_linux.go` под Linux системой и проигнорирует все остальные.

## go clean

Команда очищает файлы, которые были сгенерированы компилятором, включая следующие файлы:
	
	_obj/            // папка объектов, оставшаяся после Makefiles
	_test/           // папка тестов, оставшаяся после Makefiles
	_testmain.go     // папка gotest, оставшаяся после Makefiles
	test.out         // папка тестов, оставшаяся после Makefiles
	build.out        // папка тестов, оставшаяся после Makefiles
	*.[568ao]        // объектные файлы, оставшиеся после Makefiles

	DIR(.exe)        // сгенерирована `go build`
	DIR.test(.exe)   // сгенерирована `go test -c`
	MAINFILE(.exe)   // сгенерирована `go build MAINFILE.go`
	
Я обычно пользуюсь этой командой перед выгрузкой проекта на GitHub, чтобы очистить свои папки от мусора. Этот мусор возможно полезен для локальных испытаний, но от него мало толку для системы контроля версий.

## go fmt

Люди, которые работают с C/C++ наверно знают, что многие постоянно спорят, какой стиль кода между K&R-стилем и ANSI-стилем лучше. К счастью, в Go только один стиль кода, который может быть использован. Например, вы должны поместить левую скобку в конце строки, но никак иначе на другой строке - это приведет к ошибке компиляции! Однако, вы можете не запоминать эти правила, потому что `go fmt` сделает все за вас, стоит только запустить `go fmt <имя файла>.go` в консоли. Но к примеру  не пользуюсь этой командой так часто, потому что моя среда разработки выполняет эту команду автоматически при сохранении исходного кода. Я расмотрю вопрос об IDE в следующем разделе.

Мы обычно используем `gofmt -w` вместо `go fmt`, потому что последняя команда не сохраняет отформатированный вариант. `gofmt -w src` обработает весь проект.

## go get

Поддерживая BitBucket, Github, Google Code, Launchpad, команда служит для получения пакетов из сети. Команда совершает две вещи после того, как мы ее вызвали. Первая вещь - загрузка исходного кода, вторая - выполнение команды `go install`. Перед использованием этой команды вам нужно убедиться, что вы установили нужные инструменты:

	BitBucket (Mercurial Git)
	Github (git)
	Google Code (Git, Mercurial, Subversion)
	Launchpad (Bazaar)
	
Также убедитесь перед исользованием, что инструменты установлены корректно. Не забудьте настроить `PATH`. Скажу еще, что команда поддерживает кастомизированные доменные имена, воспользуйтесь командой `go help remote` для дополнительной информации.

## go install

Эта команда компилирует пакеты и создает бинарные файлы, которые впоследствии будут помещены в `$GOPATH/pkg` или `$GOPATH/bin`.

## go test

Эта команда грузит все файлы, чьи названия оканчиваются на `*_test.go` и генерирует тестовые файлы, выполняет из, а затем выводит информацию вроде такой:

	ok   archive/tar   0.011s
	FAIL archive/zip   0.022s
	ok   compress/gzip 0.033s
	...
	
Команда по умолчанию запускает все тесты на тестирование. Для дополнительной информации воспользуйтесь командой `go help testflag` :)

## go doc

Многие люди говорят, что мы не нуждаемся в каких-то сторонних средствах документации Go(однако я сделал [CHM](https://github.com/astaxie/godoc)), потому что Go и так имеет мощный инструмент для управления этой документацией.

Так как же получить документацию для пакета? Если вы хотите получить информацию о целом пакете, как например пакет `builtin`, воспользуйтесь командой `go doc builtin`, а для пакета `http` командой `go doc net/http`. Если вы желаете получить больше информации об определенной функции, в вашем распоряжении команда `godoc <пакет> <функция>`, а команда `godoc -src <пакет> <функция>` выведет исходный код.

Выполнив команду `godoc -http=:8080`, а затем перейдя по адресу `127.0.0.1:8080`, вы должны увидеть локализированный [golang.org](http://golang.org). Однако тут есть небольшое отличие - также будет отображаться документация из пакетов, установленных в вашей папке `$GOPATH/pkg`.

## Другие команды

Go предлагает еще несколько инструментов, о которых я скажу лишь пару слов:

	go fix // обновляет код со старых версий до go1 к новой версии после go1
	go version // выводит информацию о версии Go
	go env // выводит все переменные окружения Go
	go list // выводит список всех установленных пакетов
	go run // компилирует временные файлы и запускает приложение
	
Естественно, больше информации о командах можно получить, выполнив `go help <команда>`.

## Ссылки

- [Содержание](preface.md)
- Предыдущая секция: [$GOPATH и рабочее пространство](01.2.md)
- Следующая секция: [Инструменты разработки Go](01.4.md)
